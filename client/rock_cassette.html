<!doctype html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <title>Прокат кассет и DVD</title>
        <link rel="icon" type="image/png" href="img/cassette_logo.png">
    </head>
    <body>
        <header>
            <div class="header_bar">
                <div class="wrapper">
                    <div class="header_bar_suitacase">
                        <div class="header_bar_left">
                            <ul class="header_bar_ul">
                            <li><a href="main.html">
                            <span>ГЛАВНАЯ</span></a>
                            </li>
                            <li><a href="cassettes.html"><span>КАССЕТЫ</span></a>
                            </li>
                            <li><a href="dvds.html"><span>DVD</span></a></li>
                            </ul>
                        </div>
                        <div class="header_bar_right">
                            <div class="header_bar_cart">
                                <a href="/cart" class="cart-but">
                                <span class="cart-icon"><img src="img/cart.png" /></span>
                                 Корзина 
                                <span class="cart-count">0</span>
                                </a>
                            </div>


                            <div class="header_bar_search">
                                <form class="header_bar_search_form">
                                    <input value="" class="header_bar_search_input">
                                    <button type="button" class="header_bar_search_btn" id="btn_1">
                                        <img src="img/loupe_small.png"/>
                                    </button>
                                </form>
                            </div> 
                        </div>   
                    </div>
                </div>
            </div>
        </header>
        <main class="main_page">
            <div class="popup-bg">
              <div class="popup">
                <a class="close-popup-a"><img class="close-popup" src="img/close.png" alt=""></a>

              </div>
            </div>
            <nav class="main-page-cassettes">
                <div class="main-list-cassettes" id = "rock90_cas_list">
                    
                </div>
            </nav>
        </main>
        <footer class="main_page_footer">
            <div class="wrapper">
                <div class="main_page_footer_grid">
                    <div class="grid_item_footer">
                        <h4>Полезные ссылки</h4>
                    </div>
                </div>
            </div>
        </footer>  
        <script>

            $('.main-list-cassettes').on('click', '.img_win' , function(){
                $('.popup-bg').fadeIn(800);
                $('html').addClass('no-scroll');
            });

            $('.close-popup-a').click(function(){
                $('.popup-bg').fadeOut(800);
                $('html').removeClass('no-scroll');
            });            

            $("#btn_1").click(function(){
                $('.main-list-cassettes').empty();
                var arr = [];
                var request = $(".header_bar_search_input").val();
                if (request != ""){
                    $.getJSON("goods.json", function (objects) {
                        for (var i = objects.length-1; i >= 0; i--){
                            if (objects[i].group == request){
                                arr.push(objects[i]);
                                console.log(arr);
                            }
                        }
                        main(arr);   
                    });
                }
            });

            var rend_elements = function(objs){
                if (objs.genre == "Rock90" && objs.type == "Cassette"){
                    var html = $('<li class="main-list-cassettes-element">' + '<span class="main-list-cassettes-element-name">' + objs.name + '</span>' + '<a class="img_win">' +'<img class="main-list-cassettes-element-img" src="' + objs.img_path + '"/>' + '</a>' + '<span class="main-list-cassettes-element-price">' + objs.price + '</span>' + '<button class="main-list-cassettes-element-btn">Добавить</button>' + '</li>');
                    $('.main-list-cassettes-container').append(html);
                }
            }

            var main = function(objects){
                "use strict";
                $('.main-list-cassettes').append('<ul class="main-list-cassettes-container"></ul>');

                for (var i = objects.length-1; i >= 0; i--){
                    rend_elements(objects[i]);
                }
            }
            
           $(document).ready(function(){
                $.getJSON("goods.json", function (objects) {
                    main(objects);   
                });
            });
        </script>  
    </body>
</html>